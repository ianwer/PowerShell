































































































































Param(
[String] $YourName
)
#$YourName = "iqbal"

$Wrapper = @()
$GADUser = Get-ADUser -filter {Enabled -eq $True -and PasswordNeverExpires -eq $False} –Properties "DisplayName", "msDS-UserPasswordExpiryTimeComputed" | Select-Object -Property "Displayname",@{Name="ExpiryDate";Expression={[datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed")}}
$YourUSers = $GADUser | Where-Object { $_.DisplayName -like "*$YourName*"} 
Foreach ($user in $YourUSers)
{
	$Result = New-Object system.object
	$Result | Add-Member -MemberType NoteProperty -Name "UserName" -Value ""
    $Result | Add-Member -MemberType NoteProperty -Name "ExpiryDate" -Value ""
	$Result.UserName = $user.DisplayName
	$Result.ExpiryDate = $user.ExpiryDate
	$Result | Select UserName, ExpiryDate
	$Wrapper = $Wrapper + $Result
}

$Wrapper | Export-CSV -Path Users.csv -N






























































































































































































































oTypeInformation -Append